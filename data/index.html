<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa CPFL</title>
    <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/@tmcw/togeojson@4.2.0/dist/togeojson.umd.js"></script>
</head>
<body>
    <div id="map"></div>

    <!-- Menu Principal -->
    <div class="menu">
        <button id="btnKMZ" title="Carregar KMZ/KML"><i class="fas fa-upload"></i></button>
        <button id="btnUploadSupabase" title="Upload Supabase"><i class="fas fa-cloud-upload-alt"></i></button>
        <button id="btnCarregarProximos" title="Carregar em 20km"><i class="fas fa-map-marker-alt"></i></button>
        <button id="btnToggleMarkers" title="Exibir/Ocultar Marcadores"><i class="fas fa-map-pin"></i></button>
        <button id="btnToggleNames" title="Exibir/Ocultar Nomes"><i class="fas fa-font"></i></button>
        <button id="btnToggleLines" title="Exibir/Ocultar Linhas"><i class="fas fa-slash"></i></button>
        <button id="btnReset" title="Resetar Visão"><i class="fas fa-redo"></i></button>
        <button id="btnLocation" title="Minha Localização"><i class="fas fa-location-arrow"></i></button>
        <button id="btnLineGroups" title="Grupos de Linhas"><i class="fas fa-layer-group"></i></button>
        <button id="btnLoadedFiles" title="Arquivos Carregados"><i class="fas fa-file-alt"></i></button>
        <button id="btnStyles" title="Estilos do Mapa"><i class="fas fa-paint-brush"></i></button>
    </div>

    <!-- Barra de Busca -->
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Buscar no mapa...">
        <button id="btnSearch"><i class="fas fa-search"></i></button>
    </div>

    <!-- Resultados da Busca -->
    <div id="searchResults" class="search-results"></div>

    <!-- Menus -->
    <div id="kmzMenu" class="kmz-menu">
        <ul id="kmzList">
            <li><input type="file" id="kmzInput" accept=".kml,.kmz" onchange="document.getElementById('kmzForm').submit()">Selecionar do dispositivo...</li>
        </ul>
    </div>
    <div id="lineMenu" class="line-menu">
        <div class="line-menu-header">
            <button>Ocultar Todas</button>
            <button>Exibir Todas</button>
        </div>
        <ul id="lineGroupsList"></ul>
    </div>
    <div id="loadedFilesMenu" class="loaded-files-menu">
        <ul id="loadedFilesList"></ul>
    </div>
    <div id="styleMenu" class="style-menu">
        <ul id="styleList"></ul>
    </div>

    <!-- Footer -->
    <footer>
        Todos direitos reservados a Lucas Teixeira<br>
        <span id="last-update">Última atualização: 2025-06-09 10:29</span>
    </footer>

    <script type="module">
        import { initializeApp } from './app.js';
        window.addEventListener('DOMContentLoaded', () => {
            if (typeof maplibregl !== 'undefined') {
                initializeApp();
            } else {
                console.error('maplibregl não carregado. Verifique a conexão ou CDNs.');
            }
        });
    </script>
</body>
</html>
